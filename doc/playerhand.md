---
title: 手牌管理
---

プレイヤーの手牌の持ち方を記す。

## 基本仕様

副露部分とそうでない部分とを分けて持つ。
暗槓は他家から見えるという意味で副露部分に含める。

槓オブジェクトから大明槓・暗槓・加槓を判定できるように情報を持たせる。
手牌が門前であるかどうかを判定するのに必要になる。

副露部分は順子・刻子・槓子のシーケンスとして持つのが自然だろう。
先頭から第一、第二、第三、第四副露。

槓子 is-a 刻子として扱えるように考慮すること。

明刻・大明槓はどこから鳴いたのかを憶えておく。つまり上家・対面・下家。

明刻は加槓により明槓に変化する場合があることに注意すること。

## 宣言可能牌を分析する

牌をツモるか、他家が牌を切る直後に直ちに正しく宣言ができるように、
手牌更新時にチーなどの宣言が可能である牌すべてを調べて記録する。

例：

```text
26m334568p38s東発発

2p: [34p],
3p: [33p, 45p],
4p: [35p, 56p],
5p: [34p],
6p: [45p],
7p: [68p],
発: [発発]
```

チー・ポン・カン・アガリ別にマップを持たせる？
カンに関しては副露部分をも調べる必要がある。

手牌更新時にシャンテン数を更新する。
国士シャンテン数、七対子シャンテン数、通常シャンテン数の最小値をとる。

通常シャンテン数の計算方法は基本的には次で求める：

```text
8 - 出来面子個数 * 2 - 搭子数
```

この過程で出来面子と搭子の組み合わせの一例を列挙するのだが、ここがよくわからない。

